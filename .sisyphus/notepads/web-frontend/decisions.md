

## 2025-02-06 - GlossaryView 词汇表管理页面决策

### 决策 1: 编辑交互设计
**选择**: 点击 target 列直接内联编辑
**理由**:
- 减少操作步骤（无需点击编辑按钮）
- 直观明了，用户一看就知道可编辑
- 回车保存、ESC 取消符合常见交互习惯

**替代方案**:
- 每行编辑按钮: 增加操作步骤
- 弹窗编辑: 打断用户操作流程

### 决策 2: 导入策略选择时机
**选择**: 选择文件后弹出策略对话框
**理由**:
- 用户已表达导入意图，此时选择策略最自然
- 避免在文件选择前增加认知负担
- 可以预览文件名，帮助决策

### 决策 3: 图标实现方式
**选择**: 使用 h() 函数内联定义 SVG 组件
**理由**:
- 无需额外依赖图标库
- 组件自包含，不依赖外部资源
- 可以精确控制图标尺寸和样式

**替代方案**:
- 使用 lucide-vue-next: 增加依赖
- 使用 SVG sprite: 增加构建复杂度

### 决策 4: 搜索过滤实现
**选择**: computed 属性实时过滤
**理由**:
- 响应式更新，无需手动触发
- 同时搜索 source 和 target
- 区分大小写，符合大多数用户预期

### 决策 5: 空状态设计
**选择**: 图标 + 文字提示，区分搜索空和列表空
**理由**:
- 搜索无结果 vs 词汇表为空是不同场景
- FileJsonIcon 提供视觉提示
- 引导用户添加词条或导入文件

### 决策 6: 删除确认级别
**选择**: 单条删除用 Dialog，清空全部用 confirm()
**理由**:
- 单条删除频繁，Dialog 更友好
- 清空全部是危险操作，需要更强的确认
- confirm() 阻止用户继续操作，强调危险性

### 文件结构
```
src/views/
├── HomeView.vue
├── ConfigView.vue
└── GlossaryView.vue    # 新增
```

### 依赖关系
```
GlossaryView.vue
├── useGlossaryStore    # 词汇表状态管理
│   ├── addEntry
│   ├── removeEntry
│   ├── updateEntry
│   ├── importFromFile
│   └── exportToFile
└── Shadcn 组件        # UI 组件
```

## 2026-02-06 - ConfigView 配置页面决策

### 决策 1: 表单保存策略
**选择**: `@blur` 事件触发保存，而非实时保存
**理由**:
- 避免频繁写入 localStorage
- 减少验证触发频率
- 用户完成输入后统一保存

**替代方案**:
- 实时保存 (watch): 过于频繁，性能开销
- 手动保存按钮: 增加用户操作步骤

### 决策 2: 本地状态 vs Store 状态
**选择**: 使用本地 `form` 对象 + Store 持久化
**理由**:
- 表单编辑不影响全局状态直到确认
- 支持"恢复默认"功能
- 更好的用户体验（撤销编辑）

### 决策 3: 测试连接实现
**选择**: 直接调用 `chatCompletion()` 发送测试消息
**理由**:
- 最真实的连接测试
- 复用现有 API 服务
- 能检测 CORS、认证、模型有效性等多种问题

**替代方案**:
- 简单的 fetch 检查: 无法验证模型是否可用
- 专用健康检查端点: 并非所有 API 都支持

### 决策 4: 错误提示设计
**选择**: 内联错误提示 + 测试结果卡片
**理由**:
- 验证错误直接显示在字段下方
- 测试结果使用独立卡片，更醒目
- 颜色区分成功/失败状态

### 决策 5: 安全提示呈现
**选择**: 独立的安全提示卡片（amber 主题）
**理由**:
- 醒目的视觉提示
- 使用 amber 颜色传达警告但不紧急
- 列出具体的安全建议

### 决策 6: CORS 说明位置
**选择**: 独立的 CORS 代理说明卡片（blue 主题）
**理由**:
- 常见问题需要专门解释
- blue 主题传达信息性而非警告
- 包含具体的代理配置示例

### 文件结构
```
src/views/
├── HomeView.vue
└── ConfigView.vue    # 新增
```

### 依赖关系
```
ConfigView.vue
├── useConfigStore    # 配置状态管理
├── chatCompletion    # API 服务测试
└── Shadcn 组件      # UI 组件
```

## 2026-02-06 - TranslateView 设计决策

### 布局决策
- 采用 3 列网格布局：左侧文件列表占 1 列，右侧预览占 2 列
- 在移动端自动切换为单列布局
- 预览区域使用左右分栏显示原文和译文

### 状态管理
- 使用本地状态管理文件列表，不持久化存储
- 每个文件项包含：id, file, name, content, translatedContent, status, progress, error
- 支持的状态：idle, translating, completed, error

### 用户体验决策
- 文件上传后自动选择第一个文件显示预览
- 翻译按钮仅在有待翻译文件且配置了 API 时才可用
- 下载按钮在翻译完成后显示
- 使用 Badge 组件显示文件状态，不同状态使用不同颜色

### 技术决策
- 使用 pre 标签显示纯文本预览（非 Markdown 渲染）
- 使用 FileReader API 异步读取文件
- 使用 Blob 和 URL.createObjectURL 实现客户端下载
- 文件名格式：`原文件名.zh.md`
