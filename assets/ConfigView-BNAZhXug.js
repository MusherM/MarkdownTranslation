import{d as V,r as g,C as m,D as s,s as l,e as o,g as t,o as c,E as d,H as x,J as b,p as k,a2 as P,a3 as R,_ as h,a0 as S}from"./index-yq9kKirz.js";import{u as O,c as $}from"./openai-BtqyijjU.js";import{_,b as w,c as C,a as U}from"./CardTitle.vue_vue_type_script_setup_true_lang-BTLI79eV.js";import{_ as D,a as y,b as K}from"./Label.vue_vue_type_script_setup_true_lang-B6UYoU_-.js";const T={class:"config-view"},j={class:"max-w-2xl mx-auto space-y-6"},E={class:"space-y-2"},L={key:0,class:"text-sm text-destructive"},H={class:"space-y-2"},z={key:0,class:"text-sm text-destructive"},F={class:"space-y-2"},J={key:0,class:"text-sm text-destructive"},W={class:"space-y-2"},Z={class:"rounded-lg border p-4"},q={class:"flex items-start justify-between gap-4"},G={class:"space-y-1"},Q={class:"flex flex-wrap gap-3 pt-2"},X={key:0},Y={key:1},ee={class:"flex items-start gap-2"},se={key:0,class:"text-lg"},le={key:1,class:"text-lg"},te={class:"whitespace-pre-line"},ae=V({__name:"ConfigView",setup(oe){const n=O(),a=g({baseUrl:n.config.baseUrl,apiKey:n.config.apiKey,modelName:n.config.modelName,translateMarkdownCodeBlocks:n.config.translateMarkdownCodeBlocks}),r=g({baseUrl:"",apiKey:"",modelName:""}),f=g(!1),u=g(null);function B(i){try{const e=new URL(i);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}}function N(){let i=!0;return r.value={baseUrl:"",apiKey:"",modelName:""},a.value.baseUrl.trim()?B(a.value.baseUrl)||(r.value.baseUrl="请输入有效的 URL 地址（以 http:// 或 https:// 开头）",i=!1):(r.value.baseUrl="请输入 API 地址",i=!1),a.value.apiKey.trim()||(r.value.apiKey="请输入 API Key",i=!1),a.value.modelName.trim()||(r.value.modelName="请输入模型名称",i=!1),i}function v(){N()&&(n.config.baseUrl=a.value.baseUrl.trim(),n.config.apiKey=a.value.apiKey.trim(),n.config.modelName=a.value.modelName.trim(),n.config.translateMarkdownCodeBlocks=a.value.translateMarkdownCodeBlocks)}function A(){n.config.translateMarkdownCodeBlocks=a.value.translateMarkdownCodeBlocks}async function I(){if(N()){v(),f.value=!0,u.value=null;try{await $({baseUrl:a.value.baseUrl.trim(),apiKey:a.value.apiKey.trim(),model:a.value.modelName.trim(),messages:[{role:"user",content:"Hello"}],temperature:.2,max_tokens:10}),u.value={success:!0,message:"连接成功！API 配置正确。"}}catch(i){const e=i;u.value={success:!1,message:e.message||"连接失败，请检查配置信息。"}}finally{f.value=!1}}}function M(){n.reset(),a.value={baseUrl:n.config.baseUrl,apiKey:n.config.apiKey,modelName:n.config.modelName,translateMarkdownCodeBlocks:n.config.translateMarkdownCodeBlocks},r.value={baseUrl:"",apiKey:"",modelName:""},u.value=null}return(i,e)=>(c(),m("div",T,[s("div",j,[e[19]||(e[19]=s("div",{class:"space-y-2"},[s("h1",{class:"text-3xl font-bold tracking-tight"},"配置"),s("p",{class:"text-muted-foreground"}," 配置 OpenAI 兼容 API 的连接信息 ")],-1)),l(t(_),null,{default:o(()=>[l(t(w),null,{default:o(()=>[l(t(C),null,{default:o(()=>[...e[4]||(e[4]=[d("API 配置",-1)])]),_:1}),l(t(D),null,{default:o(()=>[...e[5]||(e[5]=[d(" 设置您的 OpenAI 兼容 API 连接信息 ",-1)])]),_:1})]),_:1}),l(t(U),{class:"space-y-6"},{default:o(()=>[s("div",E,[l(t(y),{for:"baseUrl"},{default:o(()=>[...e[6]||(e[6]=[d("API 地址",-1)])]),_:1}),l(t(K),{id:"baseUrl",modelValue:a.value.baseUrl,"onUpdate:modelValue":e[0]||(e[0]=p=>a.value.baseUrl=p),type:"url",placeholder:"https://api.openai.com/v1",class:x({"border-destructive":r.value.baseUrl}),onBlur:v},null,8,["modelValue","class"]),r.value.baseUrl?(c(),m("p",L,b(r.value.baseUrl),1)):k("",!0),e[7]||(e[7]=s("p",{class:"text-xs text-muted-foreground"}," OpenAI 兼容 API 的基础 URL，通常以 /v1 结尾 ",-1))]),s("div",H,[l(t(y),{for:"apiKey"},{default:o(()=>[...e[8]||(e[8]=[d("API Key",-1)])]),_:1}),l(t(K),{id:"apiKey",modelValue:a.value.apiKey,"onUpdate:modelValue":e[1]||(e[1]=p=>a.value.apiKey=p),type:"password",placeholder:"sk-...",class:x({"border-destructive":r.value.apiKey}),onBlur:v},null,8,["modelValue","class"]),r.value.apiKey?(c(),m("p",z,b(r.value.apiKey),1)):k("",!0),e[9]||(e[9]=s("p",{class:"text-xs text-muted-foreground"}," 您的 API 密钥，格式通常为 sk-... ",-1))]),s("div",F,[l(t(y),{for:"modelName"},{default:o(()=>[...e[10]||(e[10]=[d("模型名称",-1)])]),_:1}),l(t(K),{id:"modelName",modelValue:a.value.modelName,"onUpdate:modelValue":e[2]||(e[2]=p=>a.value.modelName=p),type:"text",placeholder:"gpt-4o-mini",class:x({"border-destructive":r.value.modelName}),onBlur:v},null,8,["modelValue","class"]),r.value.modelName?(c(),m("p",J,b(r.value.modelName),1)):k("",!0),e[11]||(e[11]=s("p",{class:"text-xs text-muted-foreground"}," 要使用的模型名称，例如：gpt-4o-mini、gpt-4o、claude-3-sonnet 等 ",-1))]),s("div",W,[s("div",Z,[s("div",q,[s("div",G,[l(t(y),{for:"translateMarkdownCodeBlocks"},{default:o(()=>[...e[12]||(e[12]=[d("是否翻译 markdown 片段",-1)])]),_:1}),e[13]||(e[13]=s("p",{class:"text-xs text-muted-foreground"},[d(" 开启后会翻译 "),s("code",null,"```md"),d("/"),s("code",null,"```markdown"),d("，以及未标注语言但可识别为 Markdown 的代码块内容（按嵌套 Markdown 文档处理） ")],-1))]),P(s("input",{id:"translateMarkdownCodeBlocks","onUpdate:modelValue":e[3]||(e[3]=p=>a.value.translateMarkdownCodeBlocks=p),type:"checkbox",class:"h-4 w-4 mt-1 accent-primary",onChange:A},null,544),[[R,a.value.translateMarkdownCodeBlocks]])])])]),s("div",Q,[l(t(h),{disabled:f.value,onClick:I},{default:o(()=>[f.value?(c(),m("span",X,"测试中...")):(c(),m("span",Y,"测试连接"))]),_:1},8,["disabled"]),l(t(h),{variant:"outline",onClick:M},{default:o(()=>[...e[14]||(e[14]=[d(" 恢复默认 ",-1)])]),_:1})]),u.value?(c(),m("div",{key:0,class:x(["p-4 rounded-lg text-sm",{"bg-green-50 text-green-800 border border-green-200":u.value.success,"bg-red-50 text-red-800 border border-red-200":!u.value.success}])},[s("div",ee,[u.value.success?(c(),m("span",se,"✓")):(c(),m("span",le,"✗")),s("div",te,b(u.value.message),1)])],2)):k("",!0)]),_:1})]),_:1}),l(t(_),{class:"border-amber-200 bg-amber-50/50"},{default:o(()=>[l(t(w),null,{default:o(()=>[l(t(C),{class:"text-amber-800 flex items-center gap-2"},{default:o(()=>[...e[15]||(e[15]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[s("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),s("path",{d:"M12 9v4"}),s("path",{d:"M12 17h.01"})],-1),d(" 安全提示 ",-1)])]),_:1})]),_:1}),l(t(U),null,{default:o(()=>[...e[16]||(e[16]=[s("ul",{class:"text-sm text-amber-800 space-y-2 list-disc list-inside"},[s("li",null,"API Key 存储在浏览器的 localStorage 中，仅在本地使用"),s("li",null,"请确保您的设备安全，避免他人获取您的 API Key"),s("li",null,"建议定期更换 API Key"),s("li",null,"不要在公共或共享设备上保存敏感配置")],-1)])]),_:1})]),_:1}),l(t(_),{class:"border-blue-200 bg-blue-50/50"},{default:o(()=>[l(t(w),null,{default:o(()=>[l(t(C),{class:"text-blue-800 flex items-center gap-2"},{default:o(()=>[...e[17]||(e[17]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[s("circle",{cx:"12",cy:"12",r:"10"}),s("path",{d:"M12 16v-4"}),s("path",{d:"M12 8h.01"})],-1),d(" CORS 代理说明 ",-1)])]),_:1})]),_:1}),l(t(U),{class:"space-y-4"},{default:o(()=>[...e[18]||(e[18]=[s("p",{class:"text-sm text-blue-800"}," 如果您遇到 CORS 错误，说明 API 服务器未配置跨域访问。您可以： ",-1),s("ul",{class:"text-sm text-blue-800 space-y-2 list-disc list-inside"},[s("li",null,"使用支持 CORS 的代理服务器（如 Cloudflare Worker）"),s("li",null,"配置浏览器扩展绕过 CORS（仅开发环境）"),s("li",null,"联系 API 提供商启用 CORS 支持")],-1),s("div",{class:"text-xs text-blue-700 bg-blue-100 p-3 rounded"},[s("strong",null,"示例代理配置："),s("br"),d(" 将 API 地址从 "),s("code",null,"https://api.example.com/v1"),s("br"),d(" 改为 "),s("code",null,"https://your-proxy.workers.dev/?target=https://api.example.com/v1")],-1)])]),_:1})]),_:1})])]))}}),ue=S(ae,[["__scopeId","data-v-060c8f89"]]);export{ue as default};
